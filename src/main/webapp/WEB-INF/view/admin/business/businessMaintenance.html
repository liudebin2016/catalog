<%
var cssPart = {
%>
<link rel="stylesheet" href="/resources/assets/css/bootstrap.min.css">
<link rel="stylesheet" href="/resources/assets/css/main.css">
<link rel="stylesheet" type="text/css" href="/resources/assets/jquery-easyui-1.4.4/themes/default/easyui.css">
<link rel="stylesheet" type="text/css" href="/resources/assets/jquery-easyui-1.4.4/themes/icon.css">
<link rel="stylesheet" type="text/css" href="/resources/assets/jquery-easyui-1.4.4//demo/demo.css">

<style type="text/css">

</style>
<%};%>


<%
var jsPart = {
%>
<script type="text/javascript" src="/resources/assets/jquery-easyui-1.4.4/jquery.min.js"></script>
<script type="text/javascript" src="/resources/assets/jquery-easyui-1.4.4/jquery.easyui.min.js"></script>
<script type="text/javascript" src="/resources/assets/jquery-easyui-1.4.4/locale/easyui-lang-zh_CN.js"></script>
<script type="text/javascript">

	//根据id删除业务
	function delBizById(id){
		$.get("/admin/business/delBiz.do", { id: id },
	    function(data){
	    	if(data=="success"){
	    		alert("删除成功！");
	    		location.reload();
	    	}
	    });
	}
	
	function resetBiz(){
		$("#bizName").val("");
		$("#bizStatus").val("");
	}
	
	//查询
	function getBizList(){
		var bizName=$.trim($("#bizName").val());
		var bizStatus=$.trim($("#bizStatus").val());
		
		$('#dg').datagrid({
		    url:'/admin/business/bizList.do', 
		    queryParams: {
				name: bizName,
				status: bizStatus
			},
		    pagination:true,
		    checkbox:true,
		    method:"get",
		    rownumbers:true,
		    fitColumns:true,
		    columns:[[    
				{field:'ck',title:'全选',width:120,checkbox:true},  
				{field:'id',title:'id',width:300,hidden:true}, 
		        {field:'name',title:'业务事项名称',width:300},    
		        {field:'shareWith',title:'共享范围',width:300,
		        	formatter:function(value,row,index){
		        		var ds=value.replace(1,"所有人员").replace(2,"国家部委").replace(3,"市领导").replace(4,"委办局").replace(5,"委（局）内")
		        		.replace(6,"本部门专员").replace(7,"其他");
		        		return ds;
	            	}
		        },
		        {field:'status',title:'当前状态',width:150,
		        	formatter:function(value,row,index){
		        		var ds=value.replace(0,"未注册").replace(1,"注册中").replace(2,"已注册").replace(3,"未通过").replace(4,"删除中");
		        		return ds;
	            	}
		        },
		        {field:'operator',title:'操作',width:220,align:"center",
		        	formatter:function(value,row,index){
		                    var s = '<a href="/admin/business/action.do?type=update&id='+row.id+'">编辑</a> ';
		                    var b = '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;';
		                    var c = '<a href="#" onclick="javascript:delBizById('+row.id+');">删除</a>';
		                    return s+b+c;
		                
		            }
		        }
		    ]]
		}); 
	}
	
	$(document).ready(function(){
		getBizList();
	});

</script>

<%};%>

<%
var htmlPart = {
%>
<!-- start:content -->
<div class="content">
   <h3 class="h3tit mt30">业务信息维护</h3>
	<div class="form-list top-search">
    	<ul class="li-fl">
        	<li>
            	<label>业务事项名称</label>
                <input class="form-control inp noradius" type="text" id="bizName" name="name" placeholder="" value="">
            </li>
        	<li class="w-state">
            	<label>当前状态</label>
                <select class="form-control sels wd148 noradius" id="bizStatus" name="status">
                  <option value="">请选择</option>
                  <option value="0">未注册</option>
                  <option value="1">注册中</option>
                  <option value="2">已注册</option>
                  <option value="3">未通过</option>
                  <option value="4">删除中</option>
                </select>
                
            </li>
        	<li>
        		<button class="btns mlt30" type="button" onclick="getBizList()">检索</button>
        		<button class="btns mlt30" type="button" onclick="resetBiz()">清空</button>
                <!-- <input class="nobg mlt10" name="清空" type="reset" value="清空">   -->                                     
            </li>
        </ul>
    </div>
    <div class="search-sel">
    	<a class="btns-gray" href="/admin/business/action.do?type=create">新建业务</a>
    	<a class="btns-gray" href="javascript:;">申请注册</a>
    	<a class="btns-gray" href="javascript:;">申请注销</a> 
    </div>           
    <!-- datagrid -->
    <table id="dg"> </table>
</div>
<!-- end:content -->
<%};
include("/layouts/admin.html",{jsSection:jsPart,htmlSection:htmlPart,cssSection:cssPart}){}
%>